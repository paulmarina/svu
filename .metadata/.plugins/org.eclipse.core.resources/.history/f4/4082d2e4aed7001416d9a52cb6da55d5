package ro.fortech.main;

import static org.elasticsearch.node.NodeBuilder.nodeBuilder;

import java.io.IOException;

import org.elasticsearch.client.Client;
import org.elasticsearch.node.Node;

import ro.fortech.business.MovieController;
import ro.fortech.model.Movie;

public class JavaApiMain {

	public static void main(String[] args) throws IOException {

		Node node = nodeBuilder().node();
		Client client = node.client();
		MovieController movieCtrl = new MovieController();
		Movie movie = new Movie("Thor", "Director",2013);
		Movie movie2 = new Movie("The Avengers", "Marvel",2012);
		Movie movie3 = new Movie("IronMan", "Robert",2013);
		Movie movie4 = new Movie("Thor", "Director",2013);
		Movie movie5 = new Movie("The Avengers", "Marvel",2012);
		Movie movie6 = new Movie("IronMan", "Robert",2013);
		
		
		
		client.prepareIndex("movies", "movie","1").setSource(movieCtrl.putJsonDocument(movie)).execute().actionGet();
		client.prepareIndex("movies", "movie","2").setSource(movieCtrl.putJsonDocument(movie2)).execute().actionGet();
		
		movieCtrl.updateDocument(client, movie3);
		
		movieCtrl.deleteDocument(client, "movies", "movie", 1);
		
		
		


		node.close();
	}

}
