package ro.fortech.main;

import static org.elasticsearch.node.NodeBuilder.nodeBuilder;

import java.io.IOException;
import java.util.Date;
import java.util.HashMap;
import java.util.Map;

import org.elasticsearch.client.Client;
import org.elasticsearch.node.Node;

public class JavaApiMain {

	public static void main(String[] args) throws IOException {

		Node node = nodeBuilder().node();
		Client client = node.client();

		client.prepareIndex("movies", "movie", "1")
				.setSource(
						putJsonDocument("The Godfather", "Francis Ford Copola",
								new Date(), new String[] { "elasticsearch" },
								"Ioana")).execute().actionGet();

		node.close();
	}

	public static Map<String, Object> putJsonDocument(String title,
			String content, Date postDate, String[] tags, String author) {

		Map<String, Object> jsonDocument = new HashMap<String, Object>();

		jsonDocument.put("title", title);
		jsonDocument.put("content", content);
		jsonDocument.put("postDate", postDate);
		jsonDocument.put("tags", tags);
		jsonDocument.put("author", author);

		return jsonDocument;
	}

}
