package ro.fortech.main;

import static org.elasticsearch.node.NodeBuilder.nodeBuilder;

import java.io.IOException;
import java.util.Date;

import org.elasticsearch.client.Client;
import org.elasticsearch.node.Node;

import ro.fortech.business.MovieController;
import ro.fortech.model.Movie;

public class JavaApiMain {

	public static void main(String[] args) throws IOException {

		Node node = nodeBuilder().node();
		Client client = node.client();
		MovieController movieCtrl = new MovieController();
		Movie movie = new Movie("Thor", "Director",2013);
		

		client.prepareIndex("movies", "movie", "2")
				.setSource(
						putJsonDocument("The Godfather", "Ronaldo",
								new Date(), new String[] { "elasticsearch" },
								"Ioana Foidas")).execute().actionGet();
		

		node.close();
	}

	/*public static Map<String, Object> putJsonDocument(String title,
			String content, Date postDate, String[] tags, String author) {

		Map<String, Object> jsonDocument = new HashMap<String, Object>();

		jsonDocument.put("title", title);
		jsonDocument.put("content", content);
		jsonDocument.put("postDate", postDate);
		jsonDocument.put("tags", tags);
		jsonDocument.put("author", author);

		return jsonDocument;
	}

	public static void getDocument(Client client, String index, String type,
			String id) {

		GetResponse getResponse = client.prepareGet(index, type, id).execute()
				.actionGet();
		Map<String, Object> source = getResponse.getSource();

		System.out.println("------------------------------");
		System.out.println("Index: " + getResponse.getIndex());
		System.out.println("Type: " + getResponse.getType());
		System.out.println("Id: " + getResponse.getId());
		System.out.println("Version: " + getResponse.getVersion());
		System.out.println(source);
		System.out.println("------------------------------");

	}*/
}
